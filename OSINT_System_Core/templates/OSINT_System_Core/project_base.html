{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>{% block page_title%}{%endblock%}</title>
  <link rel="stylesheet" href="{% static 'bootstrap/css/bootstrap.min.css' %}" />
  <link rel="stylesheet" href="{% static 'font-awesome/css/all.min.css' %}" />
  {% comment %}
  <!-- including style.css so that it should be evaluated by django -->
  <!-- <style>
      {% include 'OSINT_System_Core/css/style.css' %}
    </style> -->
  {% endcomment %}
  {% block head_dep %} {% endblock %}
  {% block head_styles %}
  {% endblock %}
  <!-- loading css with link does not evaluate static tag -->
  <link rel="stylesheet" href="{% static 'OSINT_System_Core/css/style.css' %}" />
</head>

<body>
  <!-- container fluid div -->
  <div class="container-fluid">
    <!-- header -->
    {% block header %}
    <div class="row ">
      <div class="col-lg-12 pl-5 pr-5">
        <nav class="navbar navbar-expand-lg " id="header">
          <button class="navbar-toggler bg-primary" type="button" data-toggle="collapse"
            data-target="#navbarTogglerDemo01" aria-controls="navbarTogglerDemo01" aria-expanded="false"
            aria-label="Toggle navigation">
            <span class="navbar-toggler-icon ">
              <i class="fas fa-bars" style="color:#fff; font-size:28px;"></i>
            </span>
          </button>
          <div class="collapse navbar-collapse" id="navbarTogglerDemo01">
            <div class="col-lg-2"></div>
            <div class="col-lg-8 ">
              <div class="row">
                <div class="col-lg-4 p-3">
                  <div class="row">
                    <div class="col-lg-6  list list-inline custom_center "
                      style="border-right:1px solid white;border-left:1px solid white;padding-top:35px;padding-bottom:20px;">
                      <li class="nav-item">
                        <a class="btn  nav_btn  topnavitem" href="#"
                          style="color:#fff; letter-spacing: normal;">TARGET</a>
                      </li>
                    </div>
                    <div class="col-lg-6  list list-inline custom_center "
                      style="border-right:1px solid white;padding-top:35px;padding-bottom:20px;">
                      <li class="nav-item">
                        <a class="   btn   nav_btn" href="#" style="">PORTFOLIO</a>
                      </li>
                    </div>
                  </div>
                </div>
                <div class="col-lg-4 custom_center">
                  <img src="{% static 'images/logo.svg' %}" height="120" width="250" class=" m-0 p-0">
                </div>
                <div class="col-lg-4 p-3">
                  <div class="row">
                    <div class="col-lg-6  list list-inline custom_center "
                      style="border-right:1px solid white;border-left:1px solid white;padding-top:35px;padding-bottom:20px;">
                      <li class="nav-item">
                        <a class="   btn   nav_btn" href="#" style="">CASE</a>
                      </li>
                    </div>
                    <div class="col-lg-6  list list-inline custom_center "
                      style="border-right:1px solid white;padding-top:35px;padding-bottom:20px;">
                      <li class="nav-item">
                        <a class="   btn   nav_btn" href="{% url 'Keybase_Management_System:kms_create' %}" style="">KEYBASE</a>
                      </li>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-lg-2 "></div>
          </div>
        </nav>
      </div>
    </div>
    {% endblock %}
    <!-- end header -->

    <!-- small navbar below header -->
    {% block smallnavbar %}
    {% endblock %}
    <!-- end of navbar below header -->
    <!-- start body -->
    <div class="row mt-5">
      <!-- left sidebar -->
      {% block leftsidebar %} {% endblock %}
      <!-- end of left sidebar -->
      <!-- main belly of the beast -->
      <div class="col-lg-8">
        {% block belly %} {% endblock %}
        <!-- start footer -->
        {% block footer %}
        <div class="row footer_wrapper ">
          <div class="col-lg-12 glowing_border" style="border-radius:5px;">
            <div class="row">
              <div class="col-lg-2 m-0 p-3">
                <div class="custom_center footer_div_1 ">
                  <div class="text-center  text-white " style="font-size: 10px;" id="control-msg-box">
                    Lorem ipsum dolor sit, amet consectetur adipisicing elit.
                    Eos tenetur facilis doloremque.
                  </div>
                </div>
              </div>
              <div class="col-lg-4 m-0 p-3 ">
                <div id="chart_5" class="m-0 p-0 "></div>
              </div>
              <div class="col-lg-6  m-0 p-3 ">
                <div class="row">
                  <div class="col-lg-4 ">
                    <div id="chart_6" class="m-0 p-0 "></div>
                  </div>
                  <div class="col-lg-4 ">
                    <div id="chart_7" class="m-0 p-0 "></div>
                  </div>
                  <div class="col-lg-4 ">
                    <div id="chart_8" class="m-0 p-0 "></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- start footer script -->
        <script>
          // jquery ready function
          document.addEventListener('DOMContentLoaded', function () {
            let footerRES = new ReconnectingEventSource('/events/')
            // console.log(footerRES)
            footerRES.addEventListener('message', (event) => {
              const control_msg = JSON.parse(event.data)
              // console.log(control_msg)
              const control_msg_box = $('#control-msg-box')
              control_msg_box.text(control_msg['text'])
            })
            //footer graphs
            //internet speed of crawl server
            // $.ajax({
            //   dataTyp: 'json',
            //   url: '',
            //   'success': (intspeed) => {
            //     console.log(intspeed)
            //   }
            // })
            // //crawl server state
            // $.getJSON('', (state) => {
            //   //update the graphs
            //   console.log(state)
            // })
          }) // end of jquery ready function
        </script>
        <!-- end of footer script -->
        {% endblock %}
        <!-- end footer -->
      </div>
      <!-- end of belly -->
      <!-- right sidebar -->
      {% block rightsidebar %} {% endblock %}
      <!-- end of right sidebar -->
      <!-- end body -->
    </div>
  </div>
  <!-- end of container fluid -->
  <!-- Optional JavaScript -->
  <!-- jQuery first, then Popper.js, then Bootstrap JS -->
  <script defer src="{% static 'jquery/js/jquery-3.2.1.min.js' %}"></script>
  <script defer src="{% static 'popper/js/popper.min.js' %}"></script>
  <script defer src="{% static 'bootstrap/js/bootstrap.min.js' %}"></script>
  <script defer src="{% static 'django_eventstream/json2.js' %}"></script>
  <script defer src="{% static 'django_eventstream/eventsource.min.js' %}"></script>
  <script defer src="{% static 'django_eventstream/reconnecting-eventsource.js' %}"></script>
  <script defer src="{% static 'amchart/js/core.js' %}"></script>
  <script defer src="{% static 'amchart/js/charts.js' %}"></script>
  <script defer src="{% static 'amchart/js/themes/dark.js' %}"></script>
  <script defer src="{% static 'amchart/js/themes/animated.js' %}"></script>
  <script defer src="{% static 'OSINT_System_Core/js/oss_core_chart.js' %}"></script>
  {% block foot_dep %} {% endblock %}
  {% block foot_script %} {% endblock %}

<!-- Button trigger modal -->


<!-- Modal -->
<div class="modal fade" id="linkto_portfolio" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Link To</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">


<div class="row">
    <div class="col-md-8">
        <label>Search Object</label>
         <input type="text" name="search" id="txtSearch" onkeyup="searchOpen()" />


    </div>
    <div class="col-md-4">

        <label for="cars">Choose Type:</label>
    <select id="type">
  <option value="portfolio">Portfolio</option>
  <option value="keybase">Keybase</option>
  <option value="case">Case</option>
  <option value="target">Target</option>
</select>
    </div>



</div>

    <div class="row" >
<div class="col-md-12" id="search_result">


</div>

    </div>
          <div class="row" >
<div class="col-md-12">
<div class="alert alert-light" id="response" role="alert">


</div>

</div>
    </div>

      </div>
      <div class="modal-footer">


      </div>
    </div>
  </div>
</div>
<!-- Modal End-->

  <!-- Modal -->
<div class="modal fade" id="share_resource" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Share Resource</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">


<div class="row">
    <div class="col-md-7">


 <div class="form-group">
  <label for="comment">Message</label>
  <textarea class="form-control" rows="5" id="share_message"></textarea>
</div>

    </div>
    <div class="col-md-5">

        <label for="cars">Share With:</label>
    <select id="group_type">
  <option value="tso">Target Selection Officer</option>
  <option value="tmo">Target Monitoring Officer</option>
  <option value="pao">Processing & Analysis Officer</option>
  <option value="rdo">Reporting and Documentation Officer</option>
</select>
    </div>



</div>

    <div class="row" id="search_result">


    </div>
           <div class="row" >

<div class="alert alert-light" id="share_response" role="alert">h
</div>
    </div>


      </div>
      <div class="modal-footer">

        <button type="button" onclick="submit_share()" class="btn btn-primary">Share</button>
      </div>
    </div>
  </div>
</div>
<script>
    function searchOpen() {
    var type = $('#type').val()
    var search = $('#txtSearch').empty().val()
    var data = {
        query: search,type:type
    };
    $.ajax({
        url: '{% url 'OSINT_System_Core:find_object' %}',
        data: data,
        'success': (resp) => {
                $('#search_result').empty().append(resp)

                 console.log(resp)
               },

    });
}

function submit_share() {

console.log("in submit share")
var user_group = $('#group_type').val()
    var resource_id = $('#btn_link').attr("data-id")
    var message = $('#share_message').val()

        //var beta_id = $('.btn_link').attr('data-id')
 console.log(resource_id)


    var data = {
        resource_id: resource_id,message:message,user_group:user_group
    };
    $.ajax({
        url: '{% url 'OSINT_System_Core:share_resource' %}',
        data: data,
        'success': (resp) => {

                $('#share_response').text(resp)
                 console.log(resp)
               },

    });
}
function submit_link(alpha_id) {

console.log("i m clicked")

    var beta_id = $('#btn_link').attr("data-id")
        //var beta_id = $('.btn_link').attr('data-id')
 console.log(beta_id)
    var type = $('#type').val()

    var data = {
        alpha_id: alpha_id,beta_id:beta_id,type:type
    };
    $.ajax({
        url: '{% url 'OSINT_System_Core:link_object' %}',
        data: data,
        'success': (resp) => {

                $('#response').text(resp)
                 console.log(resp)
               },

    });
}


</script>

</body>

</html>