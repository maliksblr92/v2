{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>{% block page_title%}{%endblock%}</title>
      <link rel="stylesheet" href="{% static 'bootstrap/css/bootstrap.min.css' %}" />
      <link rel="stylesheet" href="{% static 'font-awesome/css/all.min.css' %}" />
      {% comment %}
      <!-- including style.css so that it should be evaluated by django -->
      <!-- <style>
      {% include 'OSINT_System_Core/css/style.css' %}
      </style> -->
    {% endcomment %}
    {% block head_dep %} {% endblock %}
    {% block head_styles %}
    {% endblock %}
    <!-- loading css with link does not evaluate static tag -->
    <link rel="stylesheet" href="{% static 'OSINT_System_Core/css/style.css' %}" />
    <script src="{% static 'django_eventstream/json2.js' %}"></script>
    <script  src="{% static 'django_eventstream/eventsource.min.js' %}"></script>
    <script  src="{% static 'django_eventstream/reconnecting-eventsource.js' %}"></script>
    
  </head>
  <style>
  body {
  -webkit-transition: background-color 1s;
  transition: background-color 1s;
  }
  
  
  </style>
  <body class="loading">
    <script type="text/javascript">
      window.addEventListener("load",  function(){
        const loader = document.querySelector(".loader");
        loader.className += " hidden";
      });
    </script>
    <style>
    #control-msg-box{
    height: 150px;;
    overflow-y: auto;
    padding-left: 10px!important;;
    padding-top: 5px!important;;
    padding-bottom: 5px!important;;
    }
    .chart_label{
      background-color:#1cb5e0;width:150px;
   
    }
    .loader{
      position: fixed;
       z-index: 99;
       top: 0;
       left: 0;
       width: 100%;
       height: 100%;
       background-color: #fff;
       display: flex;
       justify-content: center;
       align-items: center;
    }
    .loader > img{
      width: 100px;
    }
    .loader.hidden{
      animation: fadeOut 1s;
      animation-fill-mode: forwards;;
    }
    @keyframes fadeOut{
      100%{
        opacity: 0;
        visibility: hidden;
      }
    }

    </style>
    <!-- container fluid div -->
    <div class="container-fluid">  
      <div class="loader">
        <img src="{% static 'images/loader.gif' %}" height="120" width="250" class=" m-0 p-0"/>
      </div>
      <!-- header -->
      {% block header %}
        <div class="row ">
          <div class="col-lg-12 pl-5 pr-5">
            <nav class="navbar navbar-expand-lg " id="header">
              <button class="navbar-toggler bg-primary" type="button" data-toggle="collapse"
              data-target="#navbarTogglerDemo01" aria-controls="navbarTogglerDemo01" aria-expanded="false"
              aria-label="Toggle navigation">
              <span class="navbar-toggler-icon ">
                <i class="fas fa-bars" style="color:#fff; font-size:28px;"></i>
              </span>
              </button>
              <div class="collapse navbar-collapse" id="navbarTogglerDemo01">
                <div class="col-lg-2"></div>
                <div class="col-lg-8 ">
                  <div class="row">
                    <div class="col-lg-4 p-3">
                      <div class="row">
                        <div class="col-lg-6  list list-inline custom_center "
                          style="border-right:1px solid white;border-left:1px solid white;padding-top:35px;padding-bottom:20px;">
                          <li class="nav-item">
                            <a class="btn  nav_btn  topnavitem" href="{% url 'Target_Management_System:tms_marktarget' %}"
                            style="color:#fff; letter-spacing: normal;">TARGET</a>
                          </li>
                        </div>
                        <div class="col-lg-6  list list-inline custom_center "
                          style="border-right:1px solid white;padding-top:35px;padding-bottom:20px;">
                          <li class="nav-item">
                            <a class="   btn   nav_btn" href="{% url 'Portfolio_Management_System:create_portfolio' %}" >PORTFOLIO</a>
                          </li>
                        </div>
                      </div>
                    </div>
                    <div class="col-lg-4 custom_center">
                      <a href="/core/dashboard"><img src="{% static 'images/logo.svg' %}" height="120" width="250" class=" m-0 p-0"></a>
                    </div>
                    <div class="col-lg-4 p-3">
                      <div class="row">
                        <div class="col-lg-6  list list-inline custom_center "
                          style="border-right:1px solid white;border-left:1px solid white;padding-top:35px;padding-bottom:20px;">
                          <li class="nav-item">
                            <a class="   btn   nav_btn" href="#" >CASE</a>
                          </li>
                        </div>
                        <div class="col-lg-6  list list-inline custom_center "
                          style="border-right:1px solid white;padding-top:35px;padding-bottom:20px;">
                          <li class="nav-item">
                            <a class="   btn   nav_btn" href="{% url 'Keybase_Management_System:kms_create' %}" >KEYBASE</a>
                          </li>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-lg-2 ">
                  
                </div>
              </div>
            </nav>
          </div>
        </div>
      {% endblock %}
      <!-- end header -->
      <!-- small navbar below header -->
      {% block smallnavbar %}
      {% endblock %}
      <!-- end of navbar below header -->
      <!-- start body -->
      <div class="row mt-5">
        <!-- left sidebar -->
        {% block leftsidebar %} {% endblock %}
        <!-- end of left sidebar -->
        <!-- main belly of the beast -->
        <div class="col-lg-8">
          {% block belly %} {% endblock %}
          <!-- start footer -->
          {% block footer %}
            <div class="row footer_wrapper ">
              <div class="col-lg-12 glowing_border" style="border-radius:5px;">
                <div class="row">
                  <div class="col-lg-6 m-0 p-3 d-flex flex-column">
                    <div class="footer_div_1">
                      <div class=" m-0 p-0 font-weight-bold " style="font-size: 10px;color:white" id="control-msg-box">
                      </div>
                    </div>
                    <div class="text-center">
                      <span class=" badge chart_label " >Control Box</span>
                    </div>
                  </div>
                  
                  <div class="col-lg-6  m-0 p-3">
                    <div class="row">
                      <div class="col-lg-4 d-flex flex-column">
                        <div id="chart_6" class="m-0 p-0 "></div>
                        <div class="text-center">
                          <span class=" badge chart_label  " >Upload Speed</span>
                        </div>
                      </div>
                      <div class="col-lg-4 d-flex flex-column">
                        <div id="chart_7" class="m-0 p-0 "></div>
                        <div class="text-center">
                          <span class=" badge  chart_label ">Downlaod Speed</span>
                        </div>
                      </div>
                      <div class="col-lg-4 m-0 p-0 d-flex flex-column">
                        <div id="chart_8" class="m-0 p-0 "></div>
                        <div class="text-center">
                          <span class=" badge  chart_label" >Tasks</span>
                        </div>
                        
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- start footer script -->
            <script>
            </script>
            <!-- end of footer script -->
          {% endblock %}
          <!-- end footer -->
        </div>
        <!-- end of belly -->
        <!-- right sidebar -->
        {% block rightsidebar %} {% endblock %}
        <!-- end of right sidebar -->
        <!-- end body -->
      </div>
    </div>
    <!-- end of container fluid -->
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script   src="{% static 'jquery/js/jquery-3.2.1.min.js' %}"></script>
    <script   src="{% static 'popper/js/popper.min.js' %}"></script>
    <script   src="{% static 'bootstrap/js/bootstrap.min.js' %}"></script>
    <!-- index 1 js Resources -->
    <script src="https://www.amcharts.com/lib/4/core.js"></script>
    <script src="https://www.amcharts.com/lib/4/charts.js"></script>
    <script src="https://www.amcharts.com/lib/4/themes/dark.js"></script>
    <script src="https://www.amcharts.com/lib/4/themes/animated.js"></script>
    <script src="{% static 'Additional_assets/main/js/chart.js'%}"></script>
    <script src="{% static 'Additional_assets/main/js/footer_charts.js'%}"></script>
    <script>
    $(document).ready(function () {
    console.log('ok running ')
    // jquery ready function
    const alert=0;
    let footerRES = new ReconnectingEventSource('/events/')
    footerRES.addEventListener('message', (event) => {
    console.log(event)
    rabbit_message("message")
    })
    //Alert by Ahmed
    footerRES.addEventListener('alert', (event) => {
    console.log(event)
    rabbit_message("alerts")
    })
    // jquery event function for notification f
    //document.addEventListener('DOMContentLoaded', function () {
    // let footerRES = new ReconnectingEventSource('/events/')
    // console.log(footerRES)
    footerRES.addEventListener('notification', (event) => {
    const control_msg = JSON.parse(event.data)
    console.log(control_msg)
    rabbit_message("notification")
    // })
    }) // end of jquery ready function
    function rabbit_message(window_type) {
    console.log("get top 10 messages from db for "+window_type);
    var control_msg_box = null;
    var data = {
    window_type: window_type
    };
    console.log("in rabbit mq function ")
    $.get({
    url: '{% url 'OSINT_System_Core:rabbit_message' %}',
    data: data,
    'success': (resp) => {
    console.log(resp)
    //const control_msg = JSON.parse(resp)
    if (window_type == 'notification') {
    control_msg_box = $('#notification-box')
    
    function notify() {
    control_msg_box.addClass(" border border-success")
    setTimeout(function () {
    
    control_msg_box.removeClass("border border-success")
    control_msg_box.addClass(" border border-primary")
    setTimeout(function () {
    
    control_msg_box.removeClass("border border-primary")
    control_msg_box.addClass(" border border-warning")
    setTimeout(function () {
    
    control_msg_box.removeClass("border border-warning")
    control_msg_box.addClass("border border-success")
    setTimeout(function () {
    
    control_msg_box.removeClass("border border-success")
    control_msg_box.addClass(" border border-primary")
    setTimeout(function () {
    
    control_msg_box.removeClass("border border-primary")
    control_msg_box.addClass("border border-success")
    setTimeout(function () {
    
    control_msg_box.removeClass("border border-success")
    control_msg_box.addClass("border border-primary")
    
    setTimeout(function () {
    control_msg_box.removeClass("border border-primary")
    control_msg_box.addClass("border border-warning")
    setTimeout(function () {
    control_msg_box.removeClass("border border-warning")
    control_msg_box.addClass("border border-success")
    setTimeout(function () {
    control_msg_box.removeClass("border border-success")
    control_msg_box.addClass("border border-primary")
    setTimeout(function () {
    control_msg_box.removeClass("border border-primary")
    control_msg_box.addClass("border border-warning")
    setTimeout(function () {
    control_msg_box.removeClass("border border-warning")
    control_msg_box.addClass("border border-success")
    control_msg_box.removeClass("border border-success")
    }, 1000)
    }, 1000)
    }, 1000)
    }, 1000)
    }, 1000)
    }, 1000)
    }, 1000)
    }, 1000);
    }, 1000);
    }, 1000);
    }, 1000);
    }
    
    
    notify()
    
    
    
    
    
    } else if (window_type == 'message') {
    control_msg_box = $('#control-msg-box')
    }
    else if(window_type=='alert'){
    control_msg_box = $('#alert-box')
    }
    
    //control_msg_box.append('<p class ="m-0 p-0">'+"*-> Server :"+control_msg['server_name']+" Module "+control_msg['module_name']+"Message"+control_msg['messege']+'</p>')
    control_msg_box.empty().append(resp)
    
    },
    });
    }
    rabbit_message("message")
    rabbit_message("notification")
    rabbit_message("alert")
    
    });
    </script>
    <script>
    $(document).ready(function(){
    
    });
    </script>
    <script defer src="{% static 'amchart/js/core.js' %}"></script>
    <script defer src="{% static 'amchart/js/charts.js' %}"></script>
    <script defer src="{% static 'amchart/js/themes/dark.js' %}"></script>
    <script defer src="{% static 'amchart/js/themes/animated.js' %}"></script>
    <script defer src="{% static 'OSINT_System_Core/js/oss_core_chart.js' %}"></script>
    {% block foot_dep %} {% endblock %}
    {% block foot_script %} {% endblock %}
    <!-- Button trigger modal -->
    <!-- Modal -->
    <div class="modal fade" id="linkto_portfolio" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Link To</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <div class="row">
              <div class="col-md-8">
                <label>Search Object</label>
                <input type="text" name="search" id="txtSearch" onkeyup="searchOpen()" />
              </div>
              <div class="col-md-4">
                <label for="cars">Choose Type:</label>
                <select id="type">
                  <option value="portfolio">Portfolio</option>
                  <option value="keybase">Keybase</option>
                  <option value="case">Case</option>
                  <option value="target">Target</option>
                </select>
              </div>
            </div>
            <div class="row" >
              <div class="col-md-12" id="search_result">
              </div>
            </div>
            <div class="row" >
              <div class="col-md-12">
                <div class="alert alert-light" id="response" role="alert">
                </div>
              </div>
            </div>
          </div>
          <div class="modal-footer">
          </div>
        </div>
      </div>
    </div>
    <!-- Modal End-->
    <!-- Modal -->
    <div class="modal fade" id="share_resource" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Share Resource</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <div class="row">
              <div class="col-md-7">
                <div class="form-group">
                  <label for="comment">Message</label>
                  <textarea class="form-control" rows="5" id="share_message"></textarea>
                </div>
              </div>
              <div class="col-md-5">
                <label for="cars">Share With:</label>
                <select id="group_type">
                  <option value="tso">Target Selection Officer</option>
                  <option value="tmo">Target Monitoring Officer</option>
                  <option value="pao">Processing & Analysis Officer</option>
                  <option value="rdo">Reporting and Documentation Officer</option>
                </select>
              </div>
            </div>
            <div class="row" id="search_result">
            </div>
            <div class="row" >
              <div class="alert alert-light" id="share_response" role="alert">h
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" onclick="submit_share()" class="btn btn-primary">Share</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<script>

    var beta_id_g = "";

    function open_model(beta_id,modal_type) {
        beta_id_g = beta_id
        console.log(beta_id)

        if(modal_type =='link'){
             $('#linkto_portfolio').modal('show')
        }
        else{
            $('#share_resource').modal('show')
        }

    }


    function searchOpen() {



    var type = $('#type').val()
    var search = $('#txtSearch').empty().val()
    var data = {
    query: search,type:type
    };
    $.ajax({
    url: '{% url 'OSINT_System_Core:find_object' %}',
    data: data,
    'success': (resp) => {
    $('#search_result').empty().append(resp)
    console.log(resp)
    },
    });
}

function submit_share() {

console.log("in submit share")
var user_group = $('#group_type').val()
    var resource_id = beta_id_g;
    var message = $('#share_message').val()
    //var beta_id = $('.btn_link').attr('data-id')
    console.log(resource_id)
    var data = {
    resource_id: resource_id,message:message,user_group:user_group
    };
    $.ajax({
        url: '{% url 'OSINT_System_Core:share_resource' %}',
        data: data,
        'success': (resp) => {

                $('#share_response').text(resp)
                 console.log(resp)
                beta_id_g = ""
               },

    });
}
function submit_link(alpha_id) {

console.log("i m clicked")

    var beta_id = beta_id_g ;//$('#btn_link').attr("data-id")
        //var beta_id = $('.btn_link').attr('data-id')
 console.log(beta_id)
    var type = $('#type').val()
    var data = {
    alpha_id: alpha_id,beta_id:beta_id,type:type
    };
    $.ajax({
        url: '{% url 'OSINT_System_Core:link_object' %}',
        data: data,
        'success': (resp) => {

                $('#response').text(resp)
                 console.log(resp)
                    beta_id_g = ""
               },

    });
    }
    </script>
    <script>
    
 
      am4core.ready(function () {

        // Themes begin
        am4core.useTheme(am4themes_dark);
        am4core.useTheme(am4themes_animated);
        // Themes end
  
  
  
        // Create chart instance
        var chart = am4core.create("chart_3", am4charts.RadarChart);
  
        // Add data
        chart.data = [{
          "category": "Keybase Targets",
          "value": {{ context.total_keybase_crawling_targets_added }},
          "full":100
  
        }, {
          "category": "Expired Targets",
          "value": {{ context.total_expired_targets }},
          "full":100
        }, {
          "category": "Crawling Targets Fetched",
          "value": {{ context.total_keybase_crawling_targets_fetched }},
          "full":100
        }, {
          "category": "Periodic Targets",
          "value": {{ context.total_periodic_targets }},
          "full":100
        }, 
        
        {
          "category": "Dynamic crawling Targets",
          "value": {{ context.total_dynamic_crawling_targets_added }},
          "full":100
        }, 
        
        
        {
          "category": "Dynamic Crawling Fetched",
          "value": {{ context.total_dynamic_crawling_targets_fetched }},
          "full":100
        }, 

        {
          "category": "Targets Added",
          "value": {{ context.total_targets_added }},
          "full":100
        }, 
        
        
        ];
  
        // Make chart not full circle
        chart.startAngle = -90;
        chart.endAngle = 180;
        chart.innerRadius = am4core.percent(30);
  
        // Set number format
        chart.numberFormatter.numberFormat = "#.#'%'";
  
        // Create axes
        var categoryAxis = chart.yAxes.push(new am4charts.CategoryAxis());
        categoryAxis.dataFields.category = "category";
        categoryAxis.renderer.grid.template.location = 0;
        categoryAxis.renderer.grid.template.strokeOpacity = 0;
        categoryAxis.renderer.labels.template.horizontalCenter = "right";
        categoryAxis.renderer.labels.template.fontWeight = 500;
        categoryAxis.renderer.labels.template.fontSize = 12;
  
        categoryAxis.renderer.labels.template.adapter.add("fill", function (fill, target) {
          return (target.dataItem.index >= 0) ? chart.colors.getIndex(target.dataItem.index) : fill;
        });
        categoryAxis.renderer.minGridDistance = 10;
  
        var valueAxis = chart.xAxes.push(new am4charts.ValueAxis());
        valueAxis.renderer.grid.template.strokeOpacity = 0;
        valueAxis.min = 0;
        valueAxis.max = 100;
        valueAxis.strictMinMax = true;
  
        // Create series
        var series1 = chart.series.push(new am4charts.RadarColumnSeries());
        series1.dataFields.valueX = "full";
        series1.dataFields.categoryY = "category";
        series1.clustered = false;
        series1.columns.template.fill = new am4core.InterfaceColorSet().getFor("alternativeBackground");
        series1.columns.template.fillOpacity = 0.08;
        series1.columns.template.cornerRadiusTopLeft = 20;
        series1.columns.template.strokeWidth = 0;
        series1.columns.template.radarColumn.cornerRadius = 20;
  
        var series2 = chart.series.push(new am4charts.RadarColumnSeries());
        series2.dataFields.valueX = "value";
        series2.dataFields.categoryY = "category";
        series2.clustered = false;
        series2.columns.template.strokeWidth = 0;
        series2.columns.template.tooltipText = "{category}: [bold]{value}[/]";
        series2.columns.template.radarColumn.cornerRadius = 20;
  
        series2.columns.template.adapter.add("fill", function (fill, target) {
          return chart.colors.getIndex(target.dataItem.index);
        });
  
        // Add cursor
        chart.cursor = new am4charts.RadarCursor();
  
      }); // end am4core.ready()
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
   
      am4core.ready(function() {

        // Themes begin
        am4core.useTheme(am4themes_animated);
        // Themes end
        
        // Create chart instance
        var chart = am4core.create("chart_4", am4charts.XYChart);
        chart.data=[
        {% for i in context.top_profiles_with_negative_behavior %}
           {
            "name": "{{ i }}",
            "points": 35654,
            "color": chart.colors.next(),
            "bullet": "https://www.amcharts.com/lib/images/faces/A04.png"
            },
        {% endfor %}
        ]
        
        // Create axes
        var categoryAxis = chart.xAxes.push(new am4charts.CategoryAxis());
        categoryAxis.dataFields.category = "name";
        categoryAxis.renderer.grid.template.disabled = true;
        categoryAxis.renderer.minGridDistance = 30;
        categoryAxis.renderer.inside = true;
        categoryAxis.renderer.labels.template.fill = am4core.color("#fff");
        categoryAxis.renderer.labels.template.fontSize = 20;
        
        var valueAxis = chart.yAxes.push(new am4charts.ValueAxis());
        valueAxis.renderer.grid.template.strokeDasharray = "4,4";
        valueAxis.renderer.labels.template.disabled = true;
        valueAxis.min = 0;
        
        // Do not crop bullets
        chart.maskBullets = false;
        
        // Remove padding
        chart.paddingBottom = 0;
        
        // Create series
        var series = chart.series.push(new am4charts.ColumnSeries());
        series.dataFields.valueY = "points";
        series.dataFields.categoryX = "name";
        series.columns.template.propertyFields.fill = "color";
        series.columns.template.propertyFields.stroke = "color";
        series.columns.template.column.cornerRadiusTopLeft = 15;
        series.columns.template.column.cornerRadiusTopRight = 15;
        series.columns.template.tooltipText = "{categoryX}: [bold]{valueY}[/b]";
        
        // Add bullets
        var bullet = series.bullets.push(new am4charts.Bullet());
        var image = bullet.createChild(am4core.Image);
        image.horizontalCenter = "middle";
        image.verticalCenter = "bottom";
        image.dy = 20;
        image.y = am4core.percent(100);
        image.propertyFields.href = "bullet";
        image.tooltipText = series.columns.template.tooltipText;
        image.propertyFields.fill = "color";
        image.filters.push(new am4core.DropShadowFilter());
        
        }); // end am4core.ready()
  
  
  
  
  
  
  
      am4core.ready(function () {
  
          // Themes begin
          am4core.useTheme(am4themes_animated);
          // Themes end
       
          // Create chart instance
          var chart = am4core.create("chart_1", am4charts.PieChart);
   
          // Add data
          chart.data = [{
            "source": "Keybase Targets",
            "value": {{ context.total_keybase_crawling_targets_added }}
    
          }, {
            "source": "Expired Targets",
            "value": {{ context.total_expired_targets }}
          }, {
            "source": "Crawling Targets Fetched",
            "value": {{ context.total_keybase_crawling_targets_fetched }}
          }, {
            "source": "Periodic Targets",
            "value": {{ context.total_periodic_targets }}
          }, 
          
          {
            "source": "Dynamic crawling Targets",
            "value": {{ context.total_dynamic_crawling_targets_added }}
          }, 
          
          
          {
            "source": "Dynamic Crawling Fetched",
            "value": {{ context.total_dynamic_crawling_targets_fetched }}
          }, 

          {
            "source": "Targets Added",
            "value": {{ context.total_targets_added }}
          }, 
          
          
          ];
    
          // Responsive
          chart.responsive.enabled = true;
          chart.responsive.rules.push({
            relevant: function (target) {
              if (target.pixelWidth <= 400) {
                return true;
              }
              return false;
            },
            state: function (target, stateId) {
              if (target instanceof am4charts.PieSeries) {
                var state = target.states.create(stateId);
    
                var labelState = target.labels.template.states.create(stateId);
                labelState.properties.disabled = true;
    
                var tickState = target.ticks.template.states.create(stateId);
                tickState.properties.disabled = true;
                return state;
              }
    
              return null;
            }
          });
          // Set inner radius
          chart.innerRadius = am4core.percent(50);
    
          // Add and configure Series
          var pieSeries = chart.series.push(new am4charts.PieSeries());
          pieSeries.dataFields.value = "value";
          pieSeries.dataFields.category = "source";
          pieSeries.slices.template.stroke = am4core.color("#fff");
          pieSeries.slices.template.strokeWidth = 2;
          pieSeries.slices.template.strokeOpacity = 1;
          pieSeries.labels.template.fill = am4core.color("white");
          pieSeries.slices.template.tooltipText = "{source}: {value.value}";
          pieSeries.labels.template.fontSize = 12;
    
          var rgm = new am4core.RadialGradientModifier();
          rgm.brightnesses.push(-0.8, -0.8, -0.5, 0, -0.5);
          pieSeries.slices.template.fillModifier = rgm;
          pieSeries.slices.template.strokeModifier = rgm;
          pieSeries.slices.template.strokeOpacity = 0.4;
          pieSeries.slices.template.strokeWidth = 0;
          // This creates initial animation
          pieSeries.hiddenState.properties.opacity = 1;
          pieSeries.hiddenState.properties.endAngle = -90;
          pieSeries.hiddenState.properties.startAngle = -90;
    
          pieSeries.colors.list = [
            am4core.color("#845EC2"),
            am4core.color("#D65DB1"),
            am4core.color("#FF6F91"),
            am4core.color("#FF9671"),
            am4core.color("#FFC75F"),
            am4core.color("#F9F871"),
          ];
        }); // end am4core.ready()
   
    
  
        am4core.ready(function() {

          // Themes begin
          am4core.useTheme(am4themes_animated);
          // Themes end
      
          // Create chart instance
          var chart = am4core.create("chart_2", am4charts.XYChart);
      
      
      
       

          chart.data= {{dic|safe}};
      
          var categoryAxis = chart.xAxes.push(new am4charts.CategoryAxis());
          categoryAxis.dataFields.category = "name";
          categoryAxis.renderer.grid.template.location = 0;
          categoryAxis.renderer.minGridDistance = 30;
      
          categoryAxis.renderer.labels.template.adapter.add("dy",  function(dy, target) {
            if (target.dataItem && target.dataItem.index & 2 == 2) {
              return dy + 25;
            }
            return dy;
          });
          categoryAxis.renderer.grid.template.disabled = true;
          categoryAxis.renderer.labels.template.disabled = true;
          var valueAxis = chart.yAxes.push(new am4charts.ValueAxis());
          valueAxis.renderer.line.disabled = false; //disables axis line
        valueAxis.renderer.labels.template.disabled = false; //disables labels
        valueAxis.renderer.grid.template.disabled = false;  //disables grid
          // Create series
          var series = chart.series.push(new am4charts.ColumnSeries());
          series.dataFields.valueY = "count";
          series.dataFields.categoryX = "name";
          series.name = "count";
          series.columns.template.tooltipText = "{categoryX}: [bold]{valueY}[/]";
          series.columns.template.fillOpacity = .8;
      
          var columnTemplate = series.columns.template;
          columnTemplate.strokeWidth = 2;
          columnTemplate.strokeOpacity = 1;
      
          });
   
  
  
        //$('#asd').hide();
      
    
    </script>
  </body>
</html>